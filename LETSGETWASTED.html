<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LETS GET WASTED</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<link href="https://fonts.googleapis.com/css?family=Bangers" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/face-your-fears" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/jack-frost" rel="stylesheet">

</head>
<style>

head {
	height: 0vh;
}

body {
	/*margin: 0;*/
	font-family: 'Bangers', regular;
  height: 100vh;
  background-color: #7f00ff;
  background-image: linear-gradient(19deg, #7f00ff 0%, #e100ff 100%);
}

.bodyLandscape{
  display: flex;
	justify-content: space-evenly;
	flex-direction: column;
	height: 99%;

}

.bodyPortrait{
  display: flex;
	justify-content: flex-start;
	flex-direction: column;
	height: 99%;

}

.h1margin1{
	margin: 0.6em 0em 0em 0em;
}

.h1margin0{
	margin: 0.1em 0.2em 0em 0.2em;
}

.h2margin1{
	margin: 0.8em 0.5em 0.8em 0.5em;
}

.h2margin0{
	margin: 0em 0.2em 0em 0.2em;
}

h1 {
  color: #ffffff;
	letter-spacing: 0.2rem;
	word-spacing: 0.1rem;
	
	/*margin: 1em;*/
  text-align: center;
  text-transform: uppercase;
  font-weight: 800;
  font-size: 45px;
}

h2 {
  color: #ffffff;
	letter-spacing: 0.1rem;
	word-spacing: 0.1rem;
	
	/*margin: 1em;*/
  text-align: center;
  text-transform: uppercase;
  font-weight: 500;
  font-size: 30px;

}

h3 {
	margin: 1em 0.5em 0 0.5em;
  color: #ffffff;
	letter-spacing: 0.1rem;
	word-spacing: 0.1rem;
	
  text-align: left;
  font-weight: 300;
  font-size: 20px;
}

.horror {
	color: #ff0000;
	font-weight: 550;
	font-family: 'Face Your Fears', sans-serif;
	/*font-family: 'Chiller', regular;*/
}

.imgAzione{
	width: auto;
  height: 55vmin;
  display: flex;
  position: relative;
	margin-left :auto;
	margin-right :auto;
	max-width: 95%;
}

.videoAzione{
	width: auto;
  height: 60vmin;
  display: flex;
  position: relative;
	margin-left :auto;
	margin-right :auto;
	max-width: 95%;
}

.imgAzioneLandscape{
	width: auto;
  height: 40vmin;
  display: flex;
  position: relative;
	margin:auto;
	max-width: 95%;
}

.boximg{

  border: solid black;
  border-color: black;
  float:center;
  border-width: 3px 3px 5px 5px;
  border-radius:4% 95% 6% 95%/95% 4% 92% 5%;
  transform: rotate(-2deg);
	
}

.ball {
  display: flex;
  justify-content: center;
  align-items: center;
  color: #fff;
  font: 500 5vmin/6vmin Helvetica, Arial, sans-serif;
  
  position: fixed;
	/*left: 50%;*/
  bottom: 20px;
  z-index: 3;

	margin-top: -20vmin; /* Negative half of height. */
	margin-left: -20vmin; /* Negative half of width. */

  width: 40vmin;
  height: 40vmin;
  padding: 8vmin;
  box-sizing: border-box;
  border-radius: 1em;
  background: #000040;

  cursor: pointer;
  box-shadow: 0 2vmin 2.5vmin -2vmin rgba(0, 0, 0, 0.5);
  transition: background 0.25s ease-in, color 0.25s ease-in,
    transform 0.25s ease-in 0.25s, border-radius 0.25s ease-in 0.5s;
}

.ballAudio {
  display: flex;
  justify-content: center;
  align-items: center;
  color: #fff;
  font: 500 5vmin/6vmin Helvetica, Arial, sans-serif;
  
  position: fixed;
	/*left: 50%;*/
  /*top: 20px;*/
  z-index: 3;

	margin-top: -20vmin; /* Negative half of height. */
	margin-left: -20vmin; /* Negative half of width. */

  /*width: 40vmin;
  height: 40vmin;*/
  padding: 8vmin;
  box-sizing: border-box;
  border-radius: 1em;
  background: #000040;

  cursor: pointer;
  box-shadow: 0 2vmin 2.5vmin -2vmin rgba(0, 0, 0, 0.5);
  transition: background 0.25s ease-in, color 0.25s ease-in,
    transform 0.25s ease-in 0.25s, border-radius 0.25s ease-in 0.5s;
}
.ballAudio span {
  z-index: 1;
  text-align: center;
  text-transform: uppercase;
  font-weight: 700;
  letter-spacing: 0.25vmin;
  user-select: none;
  font-size: 1.5em;
  line-height: 120%;
  font-family: 'Bangers', regular;
}
.ballAudio .large-text {
  font-size: 2.5em;
  line-height: 0.875em;
}
/*
.ballAudio::before {
	content: "";
  position: absolute;
  top: 22.5%;
  left: 5%;
  width: 90%;
  height: 80%;
  border-radius: inherit;
  background: inherit;
  filter: blur(3vmin);
}
.ballAudio::after {
	content: "";
  position: absolute;
  left: -25%;
  top: -25%;
  width: 150%;
  height: 150%;
  border: 6vmin solid #000040;
  opacity: 0.25;
  box-sizing: border-box;
  border-radius: 50%;
  transform: scale(0.5);
  transition: all 0.5s ease-in;
  z-index: -10;
}
.ballAudio:active {
	border-radius: 50%;
  transform: scale(1);
  background: #fff;
  color: navy;
  transition: border-radius 0.25s ease-out, transform 0.25s ease-out 0.25s,
    background 0.25s ease-out 0.5s, color 0.25s ease-out 0.5s;
}
.ballAudio:active::after {
  transform: scale(1);
  border-color: #fff;
  transition: all 0.25s ease-out 0.5s;
}
*/
.audiobtn{
  left: 20%;
}

.audiobtnPortrait{
	  width: 25vmin;
  	height: 25vmin;
		left: 22.5%;
		bottom: 40px;
}

.audiobtnLandscape{
	  width: 40vmin;
  	height: 40vmin;
		left: 15%;
		bottom: 20px;
}

.buttonPortrait{
		left: 50%;
}

.buttonLandscape{
		left: 83%;
}

/*
.ball {
  display: flex;
  justify-content: center;
  align-items: center;
  color: #fff;
  font: 500 5vmin/6vmin Helvetica, Arial, sans-serif;
  position: relative;
  width: 40vmin;
  height: 40vmin;
  padding: 8vmin;
  box-sizing: border-box;
  border-radius: 1em;
  background: #000;
  margin: auto;
  cursor: pointer;
  box-shadow: 0 2vmin 2.5vmin -2vmin rgba(0, 0, 0, 0.5);
  transition: background 0.25s ease-in, color 0.25s ease-in,
    transform 0.25s ease-in 0.25s, border-radius 0.25s ease-in 0.5s;
}*/
.ball::before {
  content: "";
  position: absolute;
  top: 22.5%;
  left: 5%;
  width: 90%;
  height: 80%;
  border-radius: inherit;
  background: inherit;
  filter: blur(3vmin);
}
.ball::after {
  content: "";
  position: absolute;
  left: -25%;
  top: -25%;
  width: 150%;
  height: 150%;
  border: 6vmin solid #000040;
  opacity: 0.25;
  box-sizing: border-box;
  border-radius: 50%;
  transform: scale(0.5);
  transition: all 0.5s ease-in;
  z-index: -10;
}
.ball span {
  z-index: 1;
  text-align: center;
  text-transform: uppercase;
  font-weight: 700;
  letter-spacing: 0.25vmin;
  user-select: none;
  font-size: 1.5em;
  line-height: 120%;
  font-family: 'Bangers', regular;
}
.ball .large-text {
  font-size: 2.5em;
  line-height: 0.875em;
}

.ball:active {
  border-radius: 50%;
  transform: scale(0.850);
  background: #fff;
  color: navy;
  transition: border-radius 0.25s ease-out, transform 0.25s ease-out 0.25s,
    background 0.25s ease-out 0.5s, color 0.25s ease-out 0.5s;
}
.ball:active::after {
  transform: scale(1);
  border-color: #fff;
  transition: all 0.25s ease-out 0.5s;
}

input[type="checkbox"] {
	width: 0;
	height: 0;
	visibility: hidden;
	float:center;
}

label {
  display: inline-block;
  width: 45px;
  height: 15px;
  background-color: #551759;
  border-radius: 10px;
  position: relative;
  cursor: pointer;
  transition: 0.5s;
  box-shadow: 0 0 5px #477a85;
}

label::after {
  content: "";
  width: 12px;
  height: 12px;
  background-color: #cca5cf;
  position: absolute;
  border-radius: 7px;
  top: 1.5px;
  left: 1.5px;
  transition: 0.5s;
}

input:checked + label:after {
	left: calc(100% - 1.5px);
	transform: translateX(-100%);
}

.switches{
	position: relative;
	left: 0%;
	display: inline-block;
	width: 90vw;
	margin-top: 3em;

}

.switchsinistri{
	
	position: absolute; 
	left: 0%; 
	top: 0; 
	/*background-color: lightblue;*/
}

.switchdestri{
	
	position: absolute; 
	left: 60%; 
	top: 0; 	
	/*background-color: lightgreen;*/

}

#overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.8);
  justify-content: center;
  align-items: center;
  z-index: 5;
}

#overlay img {
  width: 100vw;
  height: 100vh;
  object-fit: contain;
}

#overlayNonSelezionabile {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.0);
  justify-content: center;
  align-items: center;
  z-index: 2;
}

#imgAzioneDiv {
	z-index: 3;
}

#videoAzioneDiv {
	z-index: 3;
}

.contornoNome {
	color: red; /* Colore del testo */
  text-shadow: 
  	-1px -2px 0 #fff,
    1px -1px 0 #fff,
    -1px  1px 0 #fff,
    1px  1px 0 #fff;

}

.contornoNeroStrong {
	/*color: white; /* Colore del testo */
  text-shadow: 
  	-2px -4px 0 #000,
    1px -1px 0 #000,
    -1px  1px 0 #000,
    1px  1px 0 #000;
}

.contornoNero {
	/*color: white; /* Colore del testo */
  text-shadow: 
  	-2px -2px 0 #000,
    1px -1px 0 #000,
    -1px  1px 0 #000,
    1px  1px 0 #000;
}

.contornoBianco {
  text-shadow: 
  	-1px -1px 0 #b0b0b0,
    1px -1px 0 #b0b0b0,
    -1px  1px 0 #b0b0b0,
    1px  1px 0 #b0b0b0;
    
}

.contafatti {
	color: red;
  position: absolute;
  top: 0;
  right: 0;
  font-size: 24px;
  padding: 10px;
}

.blinking-text {
  font-size: 48px;
  color: red;
  font-weight: bold;
  text-align: center;
  text-shadow: 
  	-2px -2px 0 #000,
    1px -1px 0 #000,
    -1px  1px 0 #000,
    1px  1px 0 #000;
  animation: blink-animation 1s infinite; /* Animazione */
}

/* Definisci l'animazione per il lampeggiamento */
@keyframes blink-animation {
  0% {
    opacity: 1;
  }
  50% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}

.nascondi {
  display: none;
}

/* Sidebar */
.sidebar {
    position: fixed;
    bottom: 0;
    left: -150px; /* Nasconde la sidebar fuori schermo */
    width: 150px;
    height: 55%;
    background-color: #333;
    color: white;
    transition: left 0.3s ease;
    padding: 0px;
    box-shadow: 2px 0 5px rgba(0, 0, 0, 0.5);
    text-align: center;
    font-size: 24px;
    z-index: 3;

}

.sidebar.open {
    left: 0; /* Mostra la sidebar */
}

/* Contenuto della sidebar */
.sidebar h2 {
    margin-top: 0;
}

/* Pulsante di apertura */
.toggle-btn {
    position: fixed;
    bottom: 10px;
    left: 15px;
    z-index: 3;
    background-color: transparent;
    color: white;
    padding: 10px 15px;
    border: none;
    cursor: pointer;
    font-size: 16px;
    border-radius: 5px;
}

.gear-btn {
    background-color: transparent;
    border: none;
    cursor: pointer;
    padding: 0;
    z-index: 3;
}

.gear-icon {
    width: 50px;
    height: 50px;
    fill: #333; /* Colore dell'ingranaggio */
    transition: transform 0.3s ease;
    z-index: 3;
    filter: drop-shadow(0 0 0.75rem white);
}

.gear-btn:hover .gear-icon {
    transform: rotate(180deg); /* Rotazione al passaggio del mouse */
}

.sideButton{
	color: white;
	font-family: 'Bangers', regular;
	background-color: #333;
	font-size: 24px;
	filter: drop-shadow(0 0 1mm white);

}

.lightShadow{
	filter: drop-shadow(0 0 1mm white);
}

/* Stile delle stelle */
.stella {
  position: absolute;
  top: -21px;
  width: 20px;
  height: 20px;
  background: yellow;
  border: 2px solid black; /* Contorno nero */
  clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
  opacity: 1;
  animation: caduta-stelle 8s linear infinite;
  z-index: -1;
}

.starburst {
	position: absolute;
  top: -31px;
  width: 30px;
  height: 30px;
  background: yellow;
  border: 2px solid black; /* Contorno nero */
	/*clip-path: polygon(100% 50%,64.49% 53.88%,93.3% 75%,60.61% 60.61%,75% 93.3%,53.88% 64.49%,50% 100%,46.12% 64.49%,25% 93.3%,39.39% 60.61%,6.7% 75%,35.51% 53.88%,0% 50%,35.51% 46.12%,6.7% 25%,39.39% 39.39%,25% 6.7%,46.12% 35.51%,50% 0%,53.88% 35.51%,75% 6.7%,60.61% 39.39%,93.3% 25%,64.49% 46.12%);*/
	clip-path: polygon(100% 50%,63.86% 55.74%,85.36% 85.36%,55.74% 63.86%,50% 100%,44.26% 63.86%,14.64% 85.36%,36.14% 55.74%,0% 50%,36.14% 44.26%,14.64% 14.64%,44.26% 36.14%,50% 0%,55.74% 36.14%,85.36% 14.64%,63.86% 44.26%);
	opacity: 1;
  animation: caduta-stelle 8s linear infinite;
  z-index: -1;
}

/* Animazione delle stelle */
@keyframes caduta-stelle {
  0% {
    transform: translateY(0) translateX(0) rotate(0deg);
    opacity: 1;
  }
  70% {
    opacity: 0.5;
  }
  100% {
    transform: translateY(95vh) translateX(calc(-50px + 50px * var(--random-x))) rotate(360deg);
    opacity: 0;
  }
}

.divDado{
	position: fixed;
  top: 30%;
  left: 50%;
  color: white;
	letter-spacing: 0.2rem;
	word-spacing: 0.1rem;
	
  text-align: center;
  text-transform: uppercase;
  font-weight: 450;
  font-size: 45px;
  transform: translate(-50%, -50%);
	z-index: 5;
	
	background-color: rgba(0, 0, 0, 0.8);
	padding: 25px;
	border-radius: 5px;
	width: 90%;
	display: none;
	
	font-family: 'Jack Frost', sans-serif;
}


</style>
<body id="corpo" oncontextmenu="return false;">

  <div id="testoAzione" class="">
	
	<div id="conta-fatti" class="contafatti contornoNero"></div>
	
	<h1 id="cat-azione-Sel" class="contornoNeroStrong" >LETS GET WASTEEEED!!!</h1>
	<h2 id="azione-Sel" class="contornoNero" ></h2>
	<h3 id="regole" class="contornoNero" ></h3>
  <div id="imgAzioneDiv">
  	<img class="imgAzione boximg" id="img-Sel" src="" ondblclick="openOverlay()">
	</div>
	<div id="videoAzioneDiv">
  	<video class="videoAzione boximg" id="video-Sel" onclick="" ondblclick="">
        <source id="video-Sel-src" src="" type="video/mp4">
    </video>
	</div>
	<div id="overlay" onclick="closeOverlay()">
  	<img class="" id="img-Sel-over" src="">
  </div>
  <div id="overlayNonSelezionabile">
  </div>

	<!--div id="audio-button" class="ballAudio audiobtn">
      <span id="comandiaudio">PAUSE AUDIO</span>
  </div-->
	<div id="sceltaGioco-button" class="ball">
      <span id="sceltaGioco">DAI CAZZO</span>
  </div>
  <div id="azioneRandom-button" class="ball">
      <span id="countdown">PRESS & HOLD</span>
  </div>
  
<div class="blinking-text" id="resumeNewgame">RESUME GAME</div>

<div id="switches" class="switches contornoBianco">
		<div class="switchsinistri">
		<div id="div-ck-new-game">
				<input id="ck-new-game" name="ck-new-game" type="checkbox" />
				<label for="ck-new-game"></label>
				RESUME / NEW GAME
		<br>
		<br>
		<br>
		</div>
		
		<div id="divSceltaGioco">
		<div>
				<input id="ck-language-ita" name="ck-language" value="ITA" type="radio" hidden checked />
				&nbsp;&nbsp;&nbsp;<label for="ck-language-ita"></label>
				ITALIAN
		</div>
		<br>
		<div>
				<input id="ck-language-eng" name="ck-language" value="ENG" type="radio" hidden />
				&nbsp;&nbsp;&nbsp;<label for="ck-language-eng"></label>
				ENGLISH
		</div>
		<br>
		<br>
		<div>
				<input id="ck-actions" name="ck-actions" type="checkbox" checked />
				<label for="ck-actions"></label>
				Actions
		</div>
		<br>
		<div id="div-ck-jenga">
				<input id="ck-jenga" name="ck-jenga" type="checkbox" />
				<label for="ck-jenga"></label>
				Jenga
		<br>
		</div>
		<div>
				<input id="ck-cards" name="ck-cards" type="checkbox" checked />
				<label for="ck-cards"></label>
				Cards
		</div>
		<br>
			<div>
					<input id="ck-hot" name="ck-hot" type="checkbox" checked />
					<label for="ck-hot"></label>
					Hot
			</div>
		<br>
		<div id="div-ck-jackpot">
				<input id="ck-jackpot" name="ck-jackpot" type="checkbox" checked />
				<label for="ck-jackpot"></label>
				Jackpot
		<br>
		</div>
		<div id="div-ck-new">
				<input id="ck-new" name="ck-new" type="checkbox"  />
				<label for="ck-new"></label>
				New
		</div>
		<br>
		<div id="div-ck-brainstorm">
				<input id="ck-brainstorm" name="ck-brainstorm" type="checkbox"  />
				<label for="ck-brainstorm"></label>
				Brainstorm
		</div>
		<br>
		<br>
		<br>
		</div>
		</div>
		
		<div class="switchdestri">
		<div>
				<input id="ck-countdown" name="ck-countdown" type="checkbox"  />
				<label for="ck-countdown"></label>
				Countdown
		</div>
		<br>
		<div id="div-ck-audio">
				<input id="ck-audio" name="ck-audio" type="checkbox" checked />
				<label for="ck-audio"></label>
				Audio
		</div>
		</div>

</div><!--switches-->

<audio id="audio-azione">
  <source src="https://github.com/Didacus85/letsgetwasted/raw/main/Ezekiele.mp3" type="audio/mpeg">
</audio>

</div><!--testoAzione-->
	
<!-- Pulsante di apertura -->
<button class="gear-btn toggle-btn" id="toggleBtn">
    <svg class="gear-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M12 8.5A3.5 3.5 0 1 1 8.5 12 3.5 3.5 0 0 1 12 8.5M19.43 12.97a7.32 7.32 0 0 0 .07-1 7.32 7.32 0 0 0-.07-1l2.11-1.65a.5.5 0 0 0 .12-.63l-2-3.46a.5.5 0 0 0-.61-.22l-2.49 1a7.05 7.05 0 0 0-1.73-1L14.5 2.5a.5.5 0 0 0-.5-.5h-4a.5.5 0 0 0-.5.5l-.38 2.53a7.05 7.05 0 0 0-1.73 1l-2.49-1a.5.5 0 0 0-.61.22l-2 3.46a.5.5 0 0 0 .12.63L4.57 10a7.32 7.32 0 0 0-.07 1 7.32 7.32 0 0 0 .07 1L2.46 13.7a.5.5 0 0 0-.12.63l2 3.46a.5.5 0 0 0 .61.22l2.49-1a7.05 7.05 0 0 0 1.73 1l.38 2.53a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5l.38-2.53a7.05 7.05 0 0 0 1.73-1l2.49 1a.5.5 0 0 0 .61-.22l2-3.46a.5.5 0 0 0-.12-.63Z"/>
    </svg>
</button>

<!-- Sidebar -->
<div class="sidebar contornoNero" id="sidebar">
    
    <p></P>
    <button class="sideButton contornoNero" id="sideNome" onClick="shufflePlayer()">SHUFFLE NOME</button>
    <p></P>
    <button class="sideButton contornoNero" id="sideAudio">AUDIO ON OFF</button>
    <p></P>
    <button class="sideButton contornoNero" id="sideDado" onClick="generateRandomD20()">TIRA DADO</button>
</div>

    <div class="divDado contornoNeroStrong" id="resultDado"></div>
    
<script>

const apiKey = 'AIzaSyAM3dcFBIVc8DCwYSrfVWj0uAAUc2Xqxdo';
const sheetId = '1mpDaPQYDQbfTpigGCI6jHS38re7UKIjobeq6BLs1-w8';

var azioni = new Array();
var azioniPassate = new Array();
var audioArray = new Array();
var audioArrayPassate = new Array();
var audioArrayRandom = new Array();
var playerArrayRandom = new Array();
var playerArrayPassate = new Array();
var jackpotArrayPassate = new Array();

var rand = 0;
var randAudio = 0;
var randPlayer = 0;
var presente = 1;
var presenteAudio = 1;
var presentePlayer = 1;
var nContaFatti = 0;
var numNomiRandom = 0;

var rVect = [];
var rGame = '';
var rCateg = '';
var rValue = '';
var rImg = '';
var rSound = '';
var rVideo = '';
var rVectAudioRandom = [];
var rVectPlayerRandom = [];

window.addEventListener('beforeunload', function (e) {

  // Cancel the unload event and show browsers "Yes/No" confirmation box
  e.preventDefault();
  e.returnValue = '';     // Chrome requires returnValue to be set
  return '?';             // Older browsers need string to be returned
});

    // Funzione per caricare i dati dal Google Sheet
    function loadGoogleSheetData() {
      // Sostituisci con la tua chiave di API e ID del foglio di calcolo
      //const apiKey = 'AIzaSyAM3dcFBIVc8DCwYSrfVWj0uAAUc2Xqxdo';
      //const sheetId = '1mpDaPQYDQbfTpigGCI6jHS38re7UKIjobeq6BLs1-w8';

      // URL per accedere ai dati del Google Sheet
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/Azioni?key=${apiKey}`;
				
      // Effettua una richiesta GET per ottenere i dati
      fetch(url)
        .then(response => response.json())
        .then(data => {

          // Estrai i dati e crea elementi della lista
          data.values.forEach(row => {
            
            azioni.push(row);

          });
        })
        .catch(error => {
          console.error('Errore nella lettura dei dati:', error);
        });
    }
    
    // Funzione per caricare i dati dal Google Sheet foglio con lingua inglese
    function loadGoogleSheetDataEnglish() {
      // Sostituisci con la tua chiave di API e ID del foglio di calcolo
      //const apiKey = 'AIzaSyAM3dcFBIVc8DCwYSrfVWj0uAAUc2Xqxdo';
      //const sheetId = '1mpDaPQYDQbfTpigGCI6jHS38re7UKIjobeq6BLs1-w8';

      // URL per accedere ai dati del Google Sheet
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/AzioniEnglish?key=${apiKey}`;
				
      // Effettua una richiesta GET per ottenere i dati
      fetch(url)
        .then(response => response.json())
        .then(data => {

          // Estrai i dati e crea elementi della lista
          data.values.forEach(row => {
            
            azioni.push(row);

          });
        })
        .catch(error => {
          console.error('Errore nella lettura dei dati:', error);
        });
    }
    
    function loadGoogleSheetAudio() {
      // Sostituisci con la tua chiave di API e ID del foglio di calcolo
      //const apiKey = 'AIzaSyAM3dcFBIVc8DCwYSrfVWj0uAAUc2Xqxdo';
      //const sheetId = '1mpDaPQYDQbfTpigGCI6jHS38re7UKIjobeq6BLs1-w8';

      // URL per accedere ai dati del Google Sheet
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/Audio?key=${apiKey}`;
				
      // Effettua una richiesta GET per ottenere i dati
      fetch(url)
        .then(response => response.json())
        .then(data => {

          // Estrai i dati e crea elementi della lista
          data.values.forEach(row => {
            
            audioArrayRandom.push(row);
            //console.log(audioArrayRandom);
            //console.log(audioArrayRandom);
            //console.log(audioArrayRandom.length);

          });
          prepareAudio();
        })
        .catch(error => {
          console.error('Errore nella lettura dei dati:', error);
        });
    }
    
    function loadGoogleSheetPlayer() {
      // Sostituisci con la tua chiave di API e ID del foglio di calcolo
      //const apiKey = 'AIzaSyAM3dcFBIVc8DCwYSrfVWj0uAAUc2Xqxdo';
      //const sheetId = '1mpDaPQYDQbfTpigGCI6jHS38re7UKIjobeq6BLs1-w8';

      // URL per accedere ai dati del Google Sheet
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/Players?key=${apiKey}`;
				
      // Effettua una richiesta GET per ottenere i dati
      fetch(url)
        .then(response => response.json())
        .then(data => {

          // Estrai i dati e crea elementi della lista
          data.values.forEach(row => {
            
            playerArrayRandom.push(row);
            //console.log(playerArrayRandom);
            //console.log(playerArrayRandom.length);

          });
          //prepareAudio();
        })
        .catch(error => {
          console.error('Errore nella lettura dei dati:', error);
        });
    }

  	
		function generateRandomColor() {
		  const letters = '0123456789ABCDEF'; // Caratteri validi per rappresentare i colori in formato esadecimale
		  let color = '#';
		  for (let i = 0; i < 6; i++) {
		    color += letters[Math.floor(Math.random() * 16)]; // Scegli un carattere casuale da 'letters'
		  }
		  return color;
		}
		
		function generateRandomColorRed() {
		  const lettersR = 'ABCDEF'; // Caratteri validi per rappresentare i colori in formato esadecimale
		  const lettersG = '0'; // Caratteri validi per rappresentare i colori in formato esadecimale
		  const lettersB = '0123456789ABCDEF'; // Caratteri validi per rappresentare i colori in formato esadecimale
		  let color = '#';
		  for (let i = 0; i < 2; i++) {
		    color += lettersR[Math.floor(Math.random() * lettersR.length)]; // Scegli un carattere casuale da 'letters'
		  }
		  for (let i = 0; i < 2; i++) {
		    color += lettersG[Math.floor(Math.random() * lettersG.length)]; // Scegli un carattere casuale da 'letters'
		  }
		  for (let i = 0; i < 2; i++) {
		    color += lettersB[Math.floor(Math.random() * lettersB.length)]; // Scegli un carattere casuale da 'letters'
		  }
		  return color;
		}
		
		function generateRandomColorBlack() {
		  const lettersR = '0'; // Caratteri validi per rappresentare i colori in formato esadecimale
		  const lettersG = '0'; // Caratteri validi per rappresentare i colori in formato esadecimale
		  const lettersB = '0'; // Caratteri validi per rappresentare i colori in formato esadecimale
		  let color = '#';
		  for (let i = 0; i < 2; i++) {
		    color += lettersR[Math.floor(Math.random() * lettersR.length)]; // Scegli un carattere casuale da 'letters'
		  }
		  for (let i = 0; i < 2; i++) {
		    color += lettersG[Math.floor(Math.random() * lettersG.length)]; // Scegli un carattere casuale da 'letters'
		  }
		  for (let i = 0; i < 2; i++) {
		    color += lettersB[Math.floor(Math.random() * lettersB.length)]; // Scegli un carattere casuale da 'letters'
		  }
		  return color;
		}

		function pickRandom(){
			
			rand = 0;
			randAudio = 0;
			randPlayer = 0;
			presente = 1;
			presenteAudio = 1;
			presentePlayer = 1;

			while(presente==1){
				rand = Math.floor(Math.random()*azioni.length);
				//console.log(rand);
				//console.log(azioniPassate);
				presente=0;
	
				if(azioniPassate.indexOf(rand) !== -1){
					presente=1;
				}
				
				if(azioni.length == azioniPassate.length){
					theEnd();
					return;
				}
				console.log(azioni.length + " " + azioniPassate.length);
				console.log(rand + " presente= " + presente);
			}
			//console.log(rand);
			
			rVect = azioni[rand];
			azioniPassate.push(rand);
			azioniPassate.sort(function(a, b){return a - b});
			rGame = rVect[1];
			rCateg = rVect[2];
			rValue = rVect[3];
			rImg = rVect[4];
			rSound = rVect[5];
			rVideo = rVect[6];
			//console.log(rCateg);
			//console.log(rValue);

		}
		
		function shufflePlayer(){
			playerArrayPassate.splice(-numNomiRandom);
			if(playerArrayPassate.length == playerArrayRandom.length -1){
					let halfLength = Math.floor(playerArrayPassate.length / 2);
					// Rimuovi la prima metà degli elementi
					playerArrayPassate.splice(0, halfLength);
					console.log(playerArrayPassate);
			}
			
			var frase;
			console.log(rValue);
			if(rValue.includes("%NOME%")){
				console.log("contiene nome");
				numNomiRandom = 0;
				frase = rValue;
				while(frase.includes("%NOME%")){
					pickRandomPlayer();
					//frase = frase.replace("%NOME%",'<span class="contornoNome">'+playerArrayRandom[randPlayer]+'</span>');
					frase = frase.replace("%NOME%",'<span class="contornoNome">'+rVectPlayerRandom[0]+'</span>');
					console.log("frase= "+frase);
					numNomiRandom = numNomiRandom +1;
				}
				
			}else{
				frase = rValue;
			}
			console.log('numNomiRandom: '+numNomiRandom);
			const azioneSel = document.getElementById('azione-Sel');
			azioneSel.innerHTML=frase;
		
		}
		
		function pickRandomPlayer(){
				//console.log("presentePlayer= "+presentePlayer);
				presentePlayer=1;
				
				if(playerArrayRandom.length == playerArrayPassate.length){
					//playerArrayPassate.length = 0;
					
					// Calcola la metà del vettore
					let halfLength = Math.floor(playerArrayPassate.length / 2);
					
					// Rimuovi la prima metà degli elementi
					playerArrayPassate.splice(0, halfLength);
					console.log(playerArrayPassate);
				}
				
				while(presentePlayer==1){
				randPlayer = Math.floor(Math.random()*playerArrayRandom.length);
				//console.log("randPlayer= "+randPlayer);
				//console.log(playerArrayPassate);
				presentePlayer=0;
	
				if(playerArrayPassate.indexOf(randPlayer) !== -1){
					presentePlayer=1;
				}

			}
			playerArrayPassate.push(randPlayer);
			rVectPlayerRandom=playerArrayRandom[randPlayer];
			console.log("playerArrayRandom= " + playerArrayRandom.length + " playerArrayPassate= " + playerArrayPassate.length +" "+ playerArrayPassate);
			console.log(randPlayer + " presentePlayer= " + presentePlayer);
			console.log(playerArrayRandom[randPlayer]);
			console.log("rVectPlayerRandom: " + rVectPlayerRandom);
		}
		
		function pickRandomPlayerJackpot(){
				//console.log("presentePlayer= "+presentePlayer);
				presentePlayer=1;
				
				if(playerArrayRandom.length == jackpotArrayPassate.length){
					//jackpotArrayPassate.length = 0;
					
					// Calcola la metà del vettore
					let halfLength = Math.floor(jackpotArrayPassate.length / 2);
					
					// Rimuovi la prima metà degli elementi
					jackpotArrayPassate.splice(0, halfLength);
					console.log(jackpotArrayPassate);
				}
				
				while(presentePlayer==1){
				randPlayer = Math.floor(Math.random()*playerArrayRandom.length);
				//console.log("randPlayer= "+randPlayer);
				//console.log(jackpotArrayPassate);
				presentePlayer=0;
	
				if(jackpotArrayPassate.indexOf(randPlayer) !== -1){
					presentePlayer=1;
				}

			}
			jackpotArrayPassate.push(randPlayer);
			rVectPlayerRandom=playerArrayRandom[randPlayer];
			console.log("playerArrayRandom= " + playerArrayRandom.length + " jackpotArrayPassate= " + jackpotArrayPassate.length +" "+ jackpotArrayPassate);
			console.log(randPlayer + " presentePlayer= " + presentePlayer);
			console.log(playerArrayRandom[randPlayer]);
			console.log("rVectPlayerRandom: " + rVectPlayerRandom);
			
			// Crea 100 stelle cadenti
    	creaStelle(50);
		}

  	function azioneRandom(){
  	
  	//console.log(azioni);
  	const countdownElement = document.getElementById('countdown');
  	if(countdownElement.textContent!='PRESS & HOLD'){
  		return;	
  	}
  	
		if(azioni.length == azioniPassate.length){
			theEnd();
			return;
		}
		
		startCountdown();
		
		$('#resultDado').html('');
		$('#resultDado').hide();
		
		const ckActions = document.getElementById('ck-actions');
		const ckJenga = document.getElementById('ck-jenga');
		const ckHot = document.getElementById('ck-hot');
		const ckCards = document.getElementById('ck-cards');
		const ckNew = document.getElementById('ck-new');
		const ckJackpot = document.getElementById('ck-jackpot');
		const ckBrainstorm = document.getElementById('ck-brainstorm');
		
		
		var chkGame = 1;
		
		while(chkGame==1){
			
			pickRandom();
			
			chkGame = 0;
			console.log(rVect);
			
			if(!ckActions.checked && rGame == ''){
				chkGame=1;
			}else{
				
			}
			
			if(!ckJenga.checked && rGame == 'JENGA'){
				chkGame=1;
			}else{
				
			}
			
			if(!ckHot.checked && rGame == 'HOT'){
				chkGame=1;
			}else{
				
			}
			
			if(!ckCards.checked && rGame == 'CARDS'){
				chkGame=1;
			}else{
				
			}
			
			if(!ckNew.checked && rGame == 'NEW'){
				chkGame=1;
			}else{
				
			}
			
			if(!ckJackpot.checked && rGame == 'JACKPOT'){
				chkGame=1;
			}else{
				
			}
			
			if(!ckActions.checked && rGame == 'HORROR'){
				chkGame=1;
			}else{
				
			}
			
			if(!ckBrainstorm.checked && rGame == 'BRAINSTORM'){
				chkGame=1;
			}else{
				
			}
			
			if(rGame != '' && rGame != 'HOT' && rGame != 'CARDS' && rGame != 'NEW' && rGame != 'JACKPOT' && rGame != 'HORROR' && rGame != 'BRAINSTORM'){
				chkGame=1;
			}
			
			console.log("rGame= " + rGame + " chkGame= "+chkGame);
			
			if(azioni.length == azioniPassate.length){
				theEnd();
				return;
			}
		}


		//-----------------------------------------------------------------
		
		const regole = document.getElementById('regole');
    regole.innerHTML = '';
    $('#regole').hide();
    
		const catAzioneSel = document.getElementById('cat-azione-Sel');
    catAzioneSel.innerHTML = '';
    catAzioneSel.textContent=rCateg;
    
		const azioneSel = document.getElementById('azione-Sel');
    azioneSel.innerHTML = '';
    
    fermaAnimazioni();
    //$$
    
			var frase;
			if(rValue.includes("%NOME%")){
				console.log("contiene nome");
				numNomiRandom = 0;
				frase = rValue;
				while(frase.includes("%NOME%")){
					if(rGame == 'JACKPOT'){
						pickRandomPlayerJackpot();
					}else{
						pickRandomPlayer();
					}
					
					//frase = frase.replace("%NOME%",'<span class="contornoNome">'+playerArrayRandom[randPlayer]+'</span>');
					frase = frase.replace("%NOME%",'<span class="contornoNome">'+rVectPlayerRandom[0]+'</span>');
					console.log("frase= "+frase);
					numNomiRandom = numNomiRandom +1;
				}
				
			}else{
				frase = rValue;
			}
			//rValue = frase;
			console.log('numNomiRandom: '+numNomiRandom);
		azioneSel.innerHTML=frase;
    //azioneSel.textContent=rValue;
    $('#azione-Sel').show();
    
/*    const imgSel = document.getElementById('img-Sel');
    imgSel.innerHTML = '';
    imgSel.src='';*/
		//$('#img-Sel').attr("innerHTML",'');
		$('#img-Sel').attr("src",'');
	
    //console.log(rImg);
    if(rImg!=undefined && rImg!=''){
    	//$$$
    	if(rImg.includes("%PLAYERIMG")){
    		//rVectPlayerRandom = playerArrayRandom[0];
    		let numImg = rImg.replace("%PLAYERIMG_", "");
    		numImg = numImg.replace("%", "");
    		console.log("numImg: " + numImg);
    		playerImg = rVectPlayerRandom[numImg];

    		$('#img-Sel').attr("src",playerImg);
    	}else{
    		$('#img-Sel').attr("src",rImg);
    	}
    	
    	/*imgSel.src=rImg;*/
	    $('#img-Sel').show();
		}else{
			$('#img-Sel').hide();
		}
		if(rVideo!=undefined && rVideo!=''){
    	const audioAzione = document.getElementById('audio-azione');
    	audioAzione.pause();
    	audioAzione.src="";
    	$('#video-Sel').attr("src",rVideo);
    	//$('#video-Sel').show();
    	//$('#video-Sel').load();

		}else{
			$('#video-Sel').attr("src","");
			$('#video-Sel').hide();
		}
		
		nContaFatti=nContaFatti+1;
		const contaFatti = document.getElementById('conta-fatti');
    contaFatti.innerHTML = '';
    contaFatti.innerHTML = nContaFatti;
    
    salvaPartita();
    
    if(rGame == 'HOT'){
			var color1=generateRandomColorRed();
			var color2=generateRandomColorRed();
			$("#cat-azione-Sel").removeClass("horror");
			$("#azione-Sel").removeClass("horror");
		}else if (rGame == 'HORROR'){
			var color1=generateRandomColorBlack();
			var color2=generateRandomColorBlack();
			$("#cat-azione-Sel").addClass("horror");
			$("#azione-Sel").addClass("horror");
		}else{
			var color1=generateRandomColor();
			var color2=generateRandomColor();
			$("#cat-azione-Sel").removeClass("horror");
			$("#azione-Sel").removeClass("horror");
		}

		var newBgImage="linear-gradient(19deg, "+color1+" 0%, "+color2+" 100%)"
		
    document.body.style.backgroundImage = newBgImage;
    
    const ckAudio = document.getElementById('ck-audio');

    if(ckAudio.checked && (rVideo == undefined || rVideo == '')){
    	
    	const audioAzione = document.getElementById('audio-azione');
    	
    	if(rSound == undefined || rSound == ''){
	    	while(presenteAudio==1){
					randAudio = Math.floor(Math.random()*audioArray.length);
					presenteAudio=0;
					//console.log('randAudio:'+randAudio);
					
					if(audioArrayPassate.indexOf(randAudio) !== -1){
						presenteAudio=1;
					}
				}
				audioAzione.src=audioArray[randAudio];
				audioArrayPassate.push(randAudio);
			}else{
				audioAzione.src=rSound;
			}

			//console.log('audioArray[randAudio]:'+audioArray[randAudio]);

			if(audioArray.length == audioArrayPassate.length){
				audioArrayPassate = [];
			}
			
			try {
			  audioAzione.play();
			} catch (error) {
			  console.error(error);
			}
			
  	}
		
  	}
  	
  	function startGame(){


  		
  		loadGoogleSheetAudio();
  		loadGoogleSheetPlayer();
  		
	 		const cckNewGame = document.getElementById('ck-new-game');
  		const cckActions = document.getElementById('ck-actions');
			const cckHot = document.getElementById('ck-hot');
			const cckCards = document.getElementById('ck-cards');
			const cckNew = document.getElementById('ck-new');
			const cckJackpot = document.getElementById('ck-jackpot');
			const cckBrainstorm = document.getElementById('ck-brainstorm');
			
			
			if(!$('#ck-language-ita').is(':checked') && !$('#ck-language-eng').is(':checked')){
				alert("SELECT LANGUAGE");
				return;
			}
			
			if(cckNewGame.checked && !cckActions.checked && !cckHot.checked && !cckCards.checked && !cckNew.checked && !cckJackpot.checked && !cckBrainstorm.checked){
				alert("SELECT ACTIONS");
				return;
			}
			
			if(!cckNewGame.checked){
				caricaPartita();
			}
			
			if($('#ck-language-ita').is(':checked')){
  			loadGoogleSheetData();
  		}
  		
  		if($('#ck-language-eng').is(':checked')){
  			loadGoogleSheetDataEnglish();
  		}

  		// NO JENGA
  		const ckJenga = document.getElementById('ck-jenga');
  		if(!ckJenga.checked){
  			//$('#regole').html("REGOLE:<br>- Se fallisci l'azione bevi! <br>- Se ti rifiuti di svolgere l'azione bevi!<br> - Se ti rifiuti 3 volte di svolgere l'azione devi bere due shot preparati dai tuoi amici!<br><br>'' Ezechiele 25,17 '' Il cammino dell' uomo timorato e' minacciato da ogni parte dalle iniquita' degli esseri egoisti e dalla tirannia degli uomini malvagi. Benedetto sia colui che nel nome della carita' e della buona volonta' conduce i deboli attraverso la valle delle tenebre; perche' egli e' in verita' il pastore di suo fratello e il ricercatore dei figli smarriti. E la mia giustizia calera' sopra di loro con grandissima vendetta e furiosissimo sdegno su coloro che si proveranno ad ammorbare e infine a distruggere i miei fratelli. E tu saprai che il mio nome e' quello del Signore quando faro' calare la mia vendetta sopra di te.");
  			
  			if($('#ck-language-ita').is(':checked')){
					$('#regole').html("REGOLE:<br><br>- Se fallisci l'azione bevi! <br>- Se ti rifiuti di svolgere l'azione bevi!<br> - Se ti rifiuti 3 volte di svolgere l'azione devi bere due shot preparati dai tuoi amici!");
				}
				
				if($('#ck-language-eng').is(':checked')){
					$('#regole').html("RULES:<br><br>- If you fail the action you drink! <br>- If you refuse to perform the action you drink!<br> - If you refuse 3 times to perform the action you must drink two shots prepared by your friends!");
				}
			
  			//const audioAzione = document.getElementById('audio-azione');
  			//audioAzione.src='https://github.com/Didacus85/letsgetwasted/raw/main/Ezekiele.mp3';
  			
	  		try {
				  //audioAzione.play();
				} catch (error) {
				  console.error(error);
				}
			
  		}else{ // JENGA
  			
  			//$('#regole').html("REGOLE:<br>- Chi fa cadere il jenga beve un bicchiere alla goccia!	<br>- Se ti cade un blocchetto sul tavolo mentre estrai bevi un sorso!	<br>- Se fallisci l'azione bevi!	<br>- Se ti rifiuti 3 volte di svolgere l'azione devi bere due shot preparati dai tuoi amici!<br><br>'' Ezechiele 25,17 '' Il cammino dell' uomo timorato e' minacciato da ogni parte dalle iniquita' degli esseri egoisti e dalla tirannia degli uomini malvagi. Benedetto sia colui che nel nome della carita' e della buona volonta' conduce i deboli attraverso la valle delle tenebre; perche' egli e' in verita' il pastore di suo fratello e il ricercatore dei figli smarriti. E la mia giustizia calera' sopra di loro con grandissima vendetta e furiosissimo sdegno su coloro che si proveranno ad ammorbare e infine a distruggere i miei fratelli. E tu saprai che il mio nome e' quello del Signore quando faro' calare la mia vendetta sopra di te.");
  			//const audioAzione = document.getElementById('audio-azione');
  			//audioAzione.src='https://github.com/Didacus85/letsgetwasted/raw/main/Ezekiele.mp3';
  			
  			try {
				  audioAzione.play();
				} catch (error) {
				  console.error(error);
				}
  		}
  		
			$('#regole').show();	
  		$('#azioneRandom-button').show();
  		$('#sceltaGioco-button').hide();
  		$('#switches').hide();
  		//$('#audio-button').fadeTo(1, 0);
			$('#overlayNonSelezionabile').css("display","flex");
			$('#resumeNewgame').hide();
			$('#toggleBtn').show();
			
  	}
  	
  	function theEnd(){

	  	//const regole = document.getElementById('regole');
	    //regole.innerHTML = '';
	    
			const catAzioneSel = document.getElementById('cat-azione-Sel');
	    catAzioneSel.innerHTML = '';
	    catAzioneSel.textContent='THE END';
	    
			const azioneSel = document.getElementById('azione-Sel');
	    azioneSel.innerHTML = '';
	    
/*	    const imgSel = document.getElementById('img-Sel');
	    imgSel.innerHTML = '';
	    imgSel.src='';*/
		//$('#img-Sel').attr("innerHTML",'');
    	$('#img-Sel').attr("src",'');
			$('#img-Sel').hide();
			$('#video-Sel').attr("src",'');
			$('#video-Sel').hide();
			
			var color1='#7f00ff';
			var color2='#e100ff';
			var newBgImage="linear-gradient(19deg, "+color1+" 0%, "+color2+" 100%)"
	
	    document.body.style.backgroundImage = newBgImage;
	    
	    localStorage.clear();
	    
  	}
  	
  	function startCountdown() {
  		let timeLeft = 10;
  		
  		const ckCountdown = document.getElementById('ck-countdown');
  		
  		if(ckCountdown.checked){
  				timeLeft = 10;
  		}else{
  				timeLeft = 0;
  		}
		  
		  const countdownElement = document.getElementById('countdown');
		
		  const countdownInterval = setInterval(function() {
		    if (timeLeft <= 0) {
		      clearInterval(countdownInterval);
		      countdownElement.style.fontSize = "1.5em";
		      countdownElement.innerHTML = 'PRESS & HOLD';
		    } else {
		    	countdownElement.style.fontSize = "4em";
		      countdownElement.innerHTML = timeLeft;
		      timeLeft--;
		    }
		  }, 1000); // Intervallo di 1 secondo (1000 millisecondi)
		  
		}
  	
  	let buttonPressed = false;
		let timeout;
		
		function startTimer() {
		  // Avvia un timer di 3 secondi
		  timeout = setTimeout(function() {
		    if (buttonPressed) {
		      // Esegui l'azione desiderata
		      azioneRandom();
		    }
		  }, 750); // 3000 millisecondi (3 secondi)
		}
		
		function buttonDown() {
		  // Imposta buttonPressed a true quando il pulsante viene premuto
		  //alert("pressed");
		  buttonPressed = true;
		  startTimer();
		  opacizza();
		}
		
		function buttonUp() {
		  // Resetta il timer e imposta buttonPressed a false quando il pulsante viene rilasciato
		  //alert("released");
		  clearTimeout(timeout);
		  buttonPressed = false;
		  videoPlayPause();
		}
		
		function buttonAudioDown() {
		  // Imposta buttonAudioPressed a true quando il pulsante viene premuto
		  //alert("pressed");
		  buttonAudioPressed = true;
		  buttonAudioPression = buttonAudioPression+1;
		  startAudioTimer(buttonAudioPression);
		  //audioBtnActions();
		}
		
		function buttonAudioUp() {
		  // imposta buttonAudioPressed a false quando il pulsante viene rilasciato
		  //alert("pressed");
		  buttonAudioPressed = false;
		}

		function opacizza(){
			
			$('#azioneRandom-button').stop(true).fadeTo(1,1);
			$('#azioneRandom-button').fadeTo(3000,1);
			$('#azioneRandom-button').fadeTo(2000, 0);
		}
		/*
		function audioBtnActions(){

			$('#audio-button').stop(true).fadeTo(1,1);
			$('#audio-button').fadeTo(3000,1);
			$('#audio-button').fadeTo(2000, 0);

		}
		*/
		let buttonAudioPressed = false;
		var buttonAudioPression = 0;
		let timeoutAudio;
		let timeoutPauseResume;
		
		function startAudioTimer(buttonAudioPressionOrig) {
			
			const audioAzione = document.getElementById('audio-azione');

		  timeoutPauseResume = setTimeout(function() {
		  	//console.log('ENTRO function timeoutPauseResume');
		  	//console.log('!buttonAudioPressed '+!buttonAudioPressed);
		  	
		   	if(audioAzione.paused && !buttonAudioPressed){
		  		
		  		audioAzione.play();
		  		$('#comandiaudio').text('PAUSE AUDIO');
		  		return false;
			  }
			  
			  if(!audioAzione.paused && !buttonAudioPressed){
			  	
			  	audioAzione.pause();
			  	$('#comandiaudio').text('PLAY AUDIO');
			  	return false;
			  }
			  
		  }, 200);
		  
		  
		  // Avvia un timer di 3 secondi
		  timeoutAudio = setTimeout(function() {
		  	//console.log('ENTRO function timeoutAudio');
		  	//console.log('buttonAudioPressed '+buttonAudioPressed);
		  	
				//console.log('buttonAudioPression '+ buttonAudioPression + '  ' + buttonAudioPressionOrig);
			  
		    if (buttonAudioPressed && buttonAudioPression == buttonAudioPressionOrig) {
		      // Esegui l'azione desiderata

		      audioAzione.pause();
		      audioAzione.currentTime = 0;
		      audioAzione.play();
		      $('#comandiaudio').text('PAUSE AUDIO');
		    }
		  }, 1500); // 3000 millisecondi (3 secondi)
		}

	

		function prepareAudio(){
			
			//console.log(audioArrayRandom.length);
			
			for(i=0; i<audioArrayRandom.length; i++){
				rVectAudioRandom = audioArrayRandom[i];
				//console.log(rVectAudioRandom);
				audioArray.push(rVectAudioRandom[0]);
			}
			//console.log(audioArray);
		}
		
		function openOverlay() {
      // Mostra l'overlay
      
      $('#img-Sel-over').attr("src",$('#img-Sel').attr("src"));
      document.getElementById("overlay").style.display = "flex";

      // Disabilita lo scroll della pagina principale
      document.body.style.overflow = "hidden";
    }

    function closeOverlay() {
      // Nascondi l'overlay
      document.getElementById("overlay").style.display = "none";

      // Riabilita lo scroll della pagina principale
      document.body.style.overflow = "auto";
    }
    
		function switchPortrait(){
			
			//$('#corpo').removeClass("bodyLandscape");
			//$('#corpo').addClass("bodyPortrait");
			
			$('#testoAzione').removeClass("bodyLandscape");
			$('#testoAzione').addClass("bodyPortrait");
			
			$('#img-Sel').removeClass("imgAzioneLandscape");
			$('#img-Sel').addClass("imgAzione");
			
			$('#cat-azione-Sel').removeClass("h1margin0");
			$('#cat-azione-Sel').addClass("h1margin1");
			
			$('#azione-Sel').removeClass("h2margin0");
			$('#azione-Sel').addClass("h2margin1");
			
			$('#sceltaGioco-button').removeClass("buttonLandscape");
			$('#sceltaGioco-button').addClass("buttonPortrait");
			
			$('#azioneRandom-button').removeClass("buttonLandscape");
			$('#azioneRandom-button').addClass("buttonPortrait");
			
			//$('#audio-button').removeClass("audiobtnLandscape");
			//$('#audio-button').addClass("audiobtnPortrait");
			
		}
		
		function switchLandscape(){

			//$('#corpo').removeClass("bodyPortrait");
			//$('#corpo').addClass("bodyLandscape");
			
			$('#testoAzione').removeClass("bodyPortrait");
			$('#testoAzione').addClass("bodyLandscape");
			
			$('#img-Sel').removeClass("imgAzione");
			$('#img-Sel').addClass("imgAzioneLandscape");
			
			$('#cat-azione-Sel').removeClass("h1margin1");
			$('#cat-azione-Sel').addClass("h1margin0");
			
			$('#azione-Sel').removeClass("h2margin1");
			$('#azione-Sel').addClass("h2margin0");
			
			$('#sceltaGioco-button').removeClass("buttonPortrait");
			$('#sceltaGioco-button').addClass("buttonLandscape");
			
			$('#azioneRandom-button').removeClass("buttonPortrait");
			$('#azioneRandom-button').addClass("buttonLandscape");
			
			//$('#audio-button').removeClass("audiobtnPortrait");
			//$('#audio-button').addClass("audiobtnLandscape");
			  
		}
		
		function videoPlayPause(){
			//alert(rVideo);
			var videoElement = $('#video-Sel')[0];
			
			if (videoElement.paused && (rVideo!=undefined && rVideo!='')) {
            videoElement.play();
            $('#video-Sel').show();
      }

      if (rVideo == undefined || rVideo == '') {
            videoElement.pause();
      }
 
		}
		
		function salvaPartita() {
			
			const cckLanguageIta = document.getElementById('ck-language-ita');
			const cckLanguageEng = document.getElementById('ck-language-eng');
  		const cckActions = document.getElementById('ck-actions');
			const cckHot = document.getElementById('ck-hot');
			const cckCards = document.getElementById('ck-cards');
			const cckNew = document.getElementById('ck-new');
			const cckJackpot = document.getElementById('ck-jackpot');
			const cckBrainstorm = document.getElementById('ck-brainstorm');

      localStorage.setItem("cacheAzioniPassate", JSON.stringify(azioniPassate));
      localStorage.setItem("cacheAudioArrayPassate", JSON.stringify(audioArrayPassate));
      localStorage.setItem("cachePlayerArrayPassate", JSON.stringify(playerArrayPassate));
      localStorage.setItem("cacheJackpotArrayPassate", JSON.stringify(jackpotArrayPassate));
      localStorage.setItem("cacheNContaFatti", nContaFatti);
      localStorage.setItem("cacheChkLanguageIta", cckLanguageIta.checked);
      localStorage.setItem("cacheChkLanguageEng", cckLanguageEng.checked);
      localStorage.setItem("cacheChkActions", cckActions.checked);
      localStorage.setItem("cacheChkCards", cckCards.checked);
      localStorage.setItem("cacheChkHot", cckHot.checked);
      localStorage.setItem("cacheChkNew", cckNew.checked);
			localStorage.setItem("cacheChkJackpot", cckJackpot.checked);
			localStorage.setItem("cacheChkBrainstorm", cckBrainstorm.checked);

      
      //alert("Partita salvata nella cache!" + azioniPassate + " " + JSON.stringify(azioniPassate));
      console.log('azioniPassate: ' + azioniPassate); // Stampa l'array nella console
      console.log('audioArrayPassate: '+ audioArrayPassate); // Stampa l'array nella console
      console.log('playerArrayPassate: ' + playerArrayPassate); // Stampa l'array nella console
      console.log('jackpotArrayPassate: ' + jackpotArrayPassate); // Stampa l'array nella console
      console.log('nContaFatti: ' + nContaFatti);
      console.log('cacheChkLanguageIta: ' + localStorage.getItem("cacheChkLanguageIta"));
      console.log('cacheChkLanguageEng: ' + localStorage.getItem("cacheChkLanguageEng"));
      console.log('cacheChkActions: ' + localStorage.getItem("cacheChkActions"));
      console.log('cacheChkCards: ' + localStorage.getItem("cacheChkCards"));
      console.log('cacheChkHot: ' + localStorage.getItem("cacheChkHot"));
      console.log('cacheChkNew: ' + localStorage.getItem("cacheChkNew"));
      console.log('cacheChkJackpot: ' + localStorage.getItem("cacheChkJackpot"));
      console.log('cacheChkBrainstorm: ' + localStorage.getItem("cacheChkBrainstorm"));
    }
    
    function caricaPartita() {
    	
    	var jsonAzioniPassate = localStorage.getItem("cacheAzioniPassate");
    	var jsonAudioArrayPassate = localStorage.getItem("cacheAudioArrayPassate");
    	var jsonPlayerArrayPassate = localStorage.getItem("cachePlayerArrayPassate");
    	var jsonJackpotArrayPassate = localStorage.getItem("cacheJackpotArrayPassate");
    	nContaFatti = Number(localStorage.getItem("cacheNContaFatti"));
			//alert("Partita caricata dalla cache!" + jsonAzioniPassate + " " + jsonNContaFatti);
			//alert("Partita caricata dalla cache!" + azioniPassate + " " + jsonNContaFatti);
			
			if (jsonAzioniPassate) {
        azioniPassate = JSON.parse(jsonAzioniPassate); // Converte la stringa JSON in un array
        //alert("Array recuperato dalla cache azioniPassate: " + azioniPassate);
        console.log('azioniPassate: ' + azioniPassate); // Stampa l'array nella console
      } else {
        alert("Nessun array trovato nella cache.");
      }
      
      if (jsonAudioArrayPassate) {
        audioArrayPassate = JSON.parse(jsonAudioArrayPassate); // Converte la stringa JSON in un array
        //alert("Array recuperato dalla cache audioArrayPassate: " + audioArrayPassate);
        console.log('audioArrayPassate: '+ audioArrayPassate); // Stampa l'array nella console
      } else {
        alert("Nessun array trovato nella cache.");
      }
      
      if (jsonPlayerArrayPassate) {
        playerArrayPassate = JSON.parse(jsonPlayerArrayPassate); // Converte la stringa JSON in un array
        //alert("Array recuperato dalla cache playerArrayPassate: " + playerArrayPassate);
        console.log('playerArrayPassate: ' + playerArrayPassate); // Stampa l'array nella console
      } else {
        alert("Nessun array trovato nella cache.");
      }
      
      if (jsonJackpotArrayPassate) {
        jackpotArrayPassate = JSON.parse(jsonJackpotArrayPassate); // Converte la stringa JSON in un array
        //alert("Array recuperato dalla cache jackpotArrayPassate: " + jackpotArrayPassate);
        console.log('jackpotArrayPassate: ' + jackpotArrayPassate); // Stampa l'array nella console
      } else {
        alert("Nessun array trovato nella cache.");
      }
      
      console.log('nContaFatti: ' + nContaFatti);
      /*
      console.log('cacheChkActions: ' + localStorage.getItem("cacheChkActions"));
      console.log('cacheChkCards: ' + localStorage.getItem("cacheChkCards"));
      console.log('cacheChkHot: ' + localStorage.getItem("cacheChkHot"));
      console.log('cacheChkNew: ' + localStorage.getItem("cacheChkNew"));
      console.log('cacheChkJackpot: ' + localStorage.getItem("cacheChkJackpot"));
			
			console.log($('#ck-actions').is(':checked'));
			console.log($('#ck-cards').is(':checked'));
			console.log($('#ck-hot').is(':checked'));
			console.log($('#ck-new').is(':checked'));
			console.log($('#ck-jackpot').is(':checked'));*/
			
			if(localStorage.getItem("cacheChkLanguageIta") === 'true'){
				$('#ck-language-ita').prop('checked', true);
				console.log('language-ita ' + $('#ck-language-ita').is(':checked'));
			}else{
				$('#ck-language-ita').prop('checked', false);
			}
			
			if(localStorage.getItem("cacheChkLanguageEng") === 'true'){
				$('#ck-language-eng').prop('checked', true);
				console.log('language-eng ' + $('#ck-language-eng').is(':checked'));
			}else{
				$('#ck-language-eng').prop('checked', false);
			}
			
			if(localStorage.getItem("cacheChkActions") === 'true'){
				$('#ck-actions').prop('checked', true);
				console.log('actions ' + $('#ck-actions').is(':checked'));
			}else{
				$('#ck-actions').prop('checked', false);
			}
			
			if(localStorage.getItem("cacheChkCards") === 'true'){
				$('#ck-cards').prop('checked', true);
				console.log('cards ' + $('#ck-cards').is(':checked'));
			}else{
				$('#ck-cards').prop('checked', false);
			}
			
			if(localStorage.getItem("cacheChkHot") === 'true'){
				$('#ck-hot').prop('checked', true);
				console.log('hot ' + $('#ck-hot').is(':checked'));
			}else{
				$('#ck-hot').prop('checked', false);
			}
			
			if(localStorage.getItem("cacheChkNew") === 'true'){
				$('#ck-new').prop('checked', true);
				console.log('new ' + $('#ck-new').is(':checked'));
			}else{
				$('#ck-new').prop('checked', false);
			}
			
			if(localStorage.getItem("cacheChkJackpot") === 'true'){
				$('#ck-jackpot').prop('checked', true);
				console.log('jackpot ' + $('#ck-jackpot').is(':checked'));
			}else{
				$('#ck-jackpot').prop('checked', false);
			}
			
			if(localStorage.getItem("cacheChkBrainstorm") === 'true'){
				$('#ck-brainstorm').prop('checked', true);
				console.log('brainstorm ' + $('#ck-brainstorm').is(':checked'));
			}else{
				$('#ck-brainstorm').prop('checked', false);
			}
			
    }
    

		$(document).ready(function(){
	  	// Aggiungi gli eventi per il pulsante
			var mobile   = /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent); 
			var tstart = mobile ? "touchstart" : "mousedown";
			//$("#roll").bind(start, function(event){
	
	  	const sceltaGiocoButton = document.getElementById('sceltaGioco-button');
	  	sceltaGiocoButton.addEventListener('mousedown', startGame);
	  	sceltaGiocoButton.addEventListener('touchstart', startGame);
	  	
			const myButton = document.getElementById('azioneRandom-button');
			//myButton.addEventListener('mousedown', buttonDown);
			myButton.addEventListener('mouseup', buttonUp);
			myButton.addEventListener('mouseleave', buttonUp);
			
			myButton.addEventListener(tstart, buttonDown);
			myButton.addEventListener('touchend', buttonUp);
			myButton.addEventListener('touchmove', buttonUp);
			
			//const myAudioButton = document.getElementById('audio-button');
			const myAudioButton = document.getElementById('sideAudio');
			//myAudioButton.addEventListener('mousedown', buttonAudioDown);
			myAudioButton.addEventListener('mouseup', buttonAudioUp);
			myAudioButton.addEventListener('mouseleave', buttonAudioUp);
			
			myAudioButton.addEventListener(tstart, buttonAudioDown);
			myAudioButton.addEventListener('touchend', buttonAudioUp);
			myAudioButton.addEventListener('touchmove', buttonAudioUp);
			

	    $('#ck-new-game').change(function() {
	        if ($(this).is(':checked')) {

	          $('#divSceltaGioco').show();
	          $('#resumeNewgame').text('NEW GAME');
	          
	        } else {

	          $('#divSceltaGioco').hide();
	          $('#resumeNewgame').text('RESUME GAME');
	        }
	     });
	     
	     //localStorage.clear();
	     
	     if (localStorage.length === 0) {
            console.log("Il localStorage è vuoto. Esegui l'azione necessaria.");
            
            $('#ck-new-game').prop('checked', true);
            $('#ck-new-game').change();
            $('#ck-new-game').prop('disabled', true);
            $('#div-ck-new-game').hide();
            //$('#div-ck-new-game').addClass('nascondi');
            
        } else {
            
            console.log("Elementi in localStorage:", localStorage);
        }
        
        $(document).ready(function() {
            let sidebar = $('#sidebar');
            let toggleBtn = $('#toggleBtn');

            // Gestisci il clic sul pulsante
            toggleBtn.click(function() {
                sidebar.toggleClass('open'); // Aggiungi o rimuovi la classe 'open'
            });

            // Chiudi la sidebar se si clicca fuori
            $(document).on('click', function(e) {
                if (!$(e.target).closest('#sidebar, #toggleBtn').length && sidebar.hasClass('open')) {
                    sidebar.removeClass('open'); // Chiudi la sidebar
                }
            });
        });
		});


    // Carica i dati al caricamento della pagina
    //loadGoogleSheetData();
    //loadGoogleSheetAudio();
		switchPortrait();
		//switchLandscape();
    $('#img-Sel').hide();
    $('#video-Sel').hide();

		$('#azione-Sel').hide();
		$('#azioneRandom-button').hide();
		$('#audio-button').hide();
		//$('#regole').hide();
		$('#div-ck-jenga').hide();
		$('#div-ck-audio').hide();
		
		$('#divSceltaGioco').hide();
		$('#div-ck-new').hide();
		//$('#div-ck-jackpot').hide();
		
		$('#toggleBtn').hide();
		
		window.matchMedia("(orientation: portrait)").addEventListener("change", e => {
    const portrait = e.matches;

    if (portrait) {
    		console.log("PORTRAIT");
        //alert("PORTRAIT");
        switchPortrait();
    } else {
    		console.log("LANDSCAPE");
        //alert("LANDSCAPE");
        switchLandscape();
    }
});

function creaStelle(numStelle) {
  for (let i = 0; i < numStelle; i++) {
    const stella = document.createElement("div");
    const starburst = document.createElement("div");
    stella.classList.add("stella");
    starburst.classList.add("starburst");

    // Limita la posizione orizzontale per evitare i bordi
    const minMargin = 5; // margine minimo in vw
    const maxMargin = 95; // margine massimo in vw
    stella.style.left = minMargin + Math.random() * (maxMargin - minMargin) + "vw";
    starburst.style.left = minMargin + Math.random() * (maxMargin - minMargin) + "vw";

    // Ritardo casuale per l'animazione
    stella.style.animationDelay = Math.random() * 5 + "s";
		starburst.style.animationDelay = Math.random() * 5 + "s";
		
    // Durata casuale per variare la velocità di caduta
    stella.style.animationDuration = 2 + Math.random() * 5 + "s";
		starburst.style.animationDuration = 2 + Math.random() * 5 + "s";
    
    // Valore casuale per movimento orizzontale
    stella.style.setProperty('--random-x', Math.random());
		starburst.style.setProperty('--random-x', Math.random());
		
    // Aggiungi la stella alla pagina
    document.body.appendChild(stella);
    document.body.appendChild(starburst);
  }
}
    
function fermaAnimazioni() {
	// Seleziona tutti gli elementi con la classe "stella" e li rimuove
	document.querySelectorAll(".stella").forEach(stella => stella.remove());
	document.querySelectorAll(".starburst").forEach(stella => stella.remove());
}

  function generateRandomD20() {
  	if($('#resultDado').html() !== ''){
  		$('#resultDado').html('');
  		$('#resultDado').hide();
  	}else{
        $('#resultDado').html("GIOCATORE &nbsp;" + (Math.floor(Math.random() * 20) + 1) + "<BR>AVVERSARIO " + (Math.floor(Math.random() * 20) + 1));
        $('#resultDado').show();
    }
  }
  </script>
  

</body>
</html>